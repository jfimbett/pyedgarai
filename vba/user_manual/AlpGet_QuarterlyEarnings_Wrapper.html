
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlpGet Quarterly Earnings Function User Manual</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        pre {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            font-size: 0.9em;
            overflow-x: auto;
        }
    </style>
</head>

<body class="bg-light">

    <div class="container my-5 p-5 bg-white shadow">
        <h1 class="mb-4">AlpGet_QuarterlyEarnings Function User Manual</h1>
        <hr>

        <h2>Function Description</h2>
        <p>
            The <code>AlpGet_QuarterlyEarnings</code> function is designed to retrieve quarterly earnings data for a given
            stock ticker symbol using an API. It requires an API token for authentication. The function makes an HTTP GET
            request to a local server endpoint and parses the JSON response. The data is then written into an Excel
            spreadsheet starting from the currently active cell.
        </p>
        <p>
            The function returns a string combining the ticker and api_token for verification.
        </p>

        <h2>Usage</h2>
        <p>To use the <code>AlpGet_QuarterlyEarnings</code> function in an Excel VBA environment, follow these steps:</p>
        <ol>
            <li>Ensure that the <code>JsonConverter</code> library is available in your VBA project for JSON parsing.
                <ul>
                    <li>This can be added by importing the JSON.bas file available online.</li>
                </ul>
            </li>
            <li>Ensure you have access to a server endpoint running on <code>http://localhost:5000/quarterly_earnings</code> that accepts
                <code>ticker</code> and <code>api_token</code> as query parameters.</li>
            <li>Copy the functions into a module in your VBA project.</li>
        </ol>

        <h3>Example Code:</h3>
        <pre><code class="vba">Sub ExampleUsage()
    Dim ticker As String
    Dim api_token As String
    Dim result As String
    
    ticker = "AAPL" ' Example ticker symbol for Apple Inc.
    api_token = "your_api_token" ' Your API token
    
    result = AlpGet_QuarterlyEarnings(ticker, api_token)
    
    MsgBox "Data has been retrieved for: " & result
End Sub
</code></pre>

        <h2>Parameters</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>ticker</code></td>
                    <td>String</td>
                    <td>The stock ticker symbol for which quarterly earnings data is to be retrieved.</td>
                </tr>
                <tr>
                    <td><code>api_token</code></td>
                    <td>String</td>
                    <td>The API token used for authenticating the request.</td>
                </tr>
            </tbody>
        </table>

        <h2>Error Handling</h2>
        <p>
            If an error occurs during the HTTP request or data processing, a message box will display the error
            description, and the function will exit safely without crashing the entire application.
        </p>
    </div>

</body>

</html>
