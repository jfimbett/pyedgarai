
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlpGet_eps_revisions User Manual</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
        }
        .code-container {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', Courier, monospace;
            color: #333;
        }
        .output {
            background-color: #e9ecef;
            padding: 10px;
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AlpGet_eps_revisions User Manual</h1>
        <p>This document describes the usage of the <code>AlpGet_eps_revisions</code> function, which retrieves EPS revision data for a given stock ticker symbol and outputs the results into an Excel sheet.</p>
        
        <h2>Function Description</h2>
        <p>The <code>AlpGet_eps_revisions</code> function calls a web API using the provided stock ticker and API token to get EPS revisions data. The data includes forecast estimates for current and next quarter as well as current and next year. The data is displayed in an Excel worksheet with the following headers:</p>
        <ul>
            <li>Index</li>
            <li>0q (Current Quarter)</li>
            <li>+1q (Next Quarter)</li>
            <li>0y (Current Year)</li>
            <li>+1y (Next Year)</li>
        </ul>

        <h2>Function Syntax</h2>
        <div class="code-container">
            <pre><code>Function AlpGet_eps_revisions(ticker As String, api_token As String) As String</code></pre>
        </div>

        <h3>Parameters</h3>
        <ul>
            <li><strong>ticker</strong> - The stock ticker symbol (e.g., "AAPL").</li>
            <li><strong>api_token</strong> - The API token used for authentication.</li>
        </ul>

        <h2>Examples</h2>
        <h3>Example 1: Basic Usage</h3>
        <p>This example retrieves EPS revision data for Apple Inc. (AAPL) using a sample API token and writes the data into the active worksheet starting from the active cell.</p>
        
        <div class="code-container">
            <pre><code>
Dim result As String
result = AlpGet_eps_revisions("AAPL", "your_api_token_here")
MsgBox "Data retrieved for: " & result
            </code></pre>
        </div>
        
        <h3>Expected Output:</h3>
        <div class="output">
            <p>The data will be written into the Excel sheet starting from the active cell with the headers and EPS revisions data for the provided ticker.</p>
        </div>

        <h2>Error Handling</h2>
        <p>If an error occurs during the execution of the function, a message box will display the error description along with the line number where the error occurred.</p>

        <h2>Notes</h2>
        <ul>
            <li>The function utilizes MSXML2 for making HTTP requests and requires a JSON parsing library, such as "VBA-JSON", to interpret the API response.</li>
            <li>Ensure that the API endpoint is accessible from your network in order to retrieve the data successfully.</li>
        </ul>
    </div>
</body>
</html>
