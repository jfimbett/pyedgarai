
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlpGet_History_Metadata Function User Manual</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        pre.vba-code { 
            background-color: #f8f9fa; 
            border: 1px solid #ddd; 
            padding: 10px;
            font-family: "Courier New", Courier, monospace;
            white-space: pre-wrap; 
        }
    </style>
</head>
<body>

<div class="container mt-5">
    <h1>AlpGet_History_Metadata Function User Manual</h1>
    <p>The <code>AlpGet_History_Metadata</code> function is designed to interact with a local API server to retrieve metadata for historical stock data.</p>
    
    <h2>Function Overview</h2>
    <p>This function makes an HTTP GET request to a predefined endpoint to fetch metadata related to a specified stock ticker. It uses an API token for authentication. The response, assumed to be in JSON format, is parsed and written to an active worksheet in Excel.</p>
    
    <h3>Function Signature</h3>
    <pre class="vba-code">
Function AlpGet_History_Metadata(ticker As String, api_token As String) As String
    ...
End Function
    </pre>
    
    <h2>Usage</h2>
    <p>To use the <code>AlpGet_History_Metadata</code> function in your VBA project, follow these examples:</p>
    
    <h3>Example</h3>
    <p>Suppose you want to retrieve metadata for the stock ticker "AAPL" using your API token "your_api_token". You would use the function as follows:</p>
    
    <pre class="vba-code">
Sub ExampleUsage()
    Dim ticker As String
    Dim apiToken As String
    Dim result As String
    
    ticker = "AAPL"
    apiToken = "your_api_token"
    
    result = AlpGet_History_Metadata(ticker, apiToken)
    MsgBox "Request sent for ticker: " & result
End Sub
    </pre>

    <h2>Output</h2>
    <p>The output will be displayed in the currently active Excel sheet, starting from the active cell. The first row will contain the headers of the metadata fields, and subsequent rows will contain the metadata values for each item returned in the response.</p>
    
    <h2>Error Handling</h2>
    <p>If an error occurs during the request or processing, a message box will display the error details. Ensure that your API server is running and the endpoint is correct to avoid errors.</p>
    
    <footer class="mt-5">
        <p>&copy; 2023 AlpGet_History_Metadata User Manual. All rights reserved.</p>
    </footer>
</div>

</body>
</html>
