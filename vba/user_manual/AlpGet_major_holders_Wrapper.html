
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Major Holders Function User Manual</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .code-snippet {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            font-family: Consolas, monospace;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1 class="mt-5">Major Holders Function User Manual</h1>
        <p class="lead">This document provides details about the function <code>AlpGet_major_holders</code> and how to use it.</p>
        
        <h2>Function Purpose</h2>
        <p>The function retrieves major holders' data for a specified stock ticker from a given API endpoint, and populates the data into an active Excel sheet starting from the current selection.</p>
        
        <h2>Function Syntax</h2>
        <div class="code-snippet">
            <p><code>AlpGet_major_holders(ticker As String, api_token As String) As String</code></p>
        </div>

        <h2>Parameters</h2>
        <ul>
            <li><strong>ticker:</strong> The stock ticker symbol (e.g., "AAPL").</li>
            <li><strong>api_token:</strong> The API token for authentication.</li>
        </ul>

        <h2>Return Value</h2>
        <p>Returns a string in the format "<code>ticker-api_token</code>".</p>

        <h2>Example Usage</h2>
        <p>To use the function within an Excel VBA macro, place the following code:</p>
        <div class="code-snippet">
            <code>
            Sub ExampleUsage()<br>
            &nbsp;&nbsp;&nbsp;&nbsp;Dim result As String<br>
            &nbsp;&nbsp;&nbsp;&nbsp;result = AlpGet_major_holders("AAPL", "your_api_token")<br>
            &nbsp;&nbsp;&nbsp;&nbsp;MsgBox result<br>
            End Sub
            </code>
        </div>

        <h2>Expected Output</h2>
        <p>Once executed, the data for the major holders (Breakdown, Insiders Percent Held, Institutions Percent Held, Institutions Float Percent Held, Institutions Count) will be displayed in the active Excel sheet starting from the selected cell. Additionally, a message box showing the ticker and api_token concatenated will be displayed.</p>
        
        <h2>Error Handling</h2>
        <p>If an error occurs, a message will appear describing the error, and execution will be terminated.</p>

    </div>

</body>
</html>
