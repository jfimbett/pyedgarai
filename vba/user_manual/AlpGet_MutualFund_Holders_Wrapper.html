
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>User Manual: AlpGet_MutualFund_Holders</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            margin: 20px;
        }

        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;
        }

        pre {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
        }

        h1, h2, h3 {
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="mb-4">AlpGet_MutualFund_Holders Function</h1>
        <p>The <code>AlpGet_MutualFund_Holders</code> function is designed to fetch mutual fund holders' data for a given stock ticker symbol using an API. It processes the response data and writes it to an Excel worksheet starting from the currently active cell. For simplicity, it requires a wrapper function <code>AlpGet_MutualFund_Holders_Wrapper</code> to handle HTTP requests and JSON parsing.</p>

        <h2>Function Definition</h2>
        <pre><code>Function AlpGet_MutualFund_Holders(ticker As String, api_token As String) As String
    Dim result As String
    result = Evaluate("AlpGet_MutualFund_Holders_Wrapper(""" & ticker & """, """ & api_token & """)")
    AlpGet_MutualFund_Holders = result
End Function
</code></pre>

        <h2>Parameters</h2>
        <ul>
            <li><strong>ticker:</strong> <code>String</code> - The stock ticker symbol for which mutual fund holders' data is to be fetched.</li>
            <li><strong>api_token:</strong> <code>String</code> - Your API token for authentication with the mutual funds data provider.</li>
        </ul>

        <h2>Returns</h2>
        <p>The function returns a string message indicating the status of the operation, which is "Success" if data retrieval and writing to Excel were successful.</p>

        <h2>Usage Example</h2>
        <p>Here's an example of how you might use the <code>AlpGet_MutualFund_Holders</code> function in an Excel VBA macro:</p>
        <pre><code>Sub GetMutualFundData()
    Dim ticker As String
    Dim api_token As String
    Dim status As String

    ticker = "AAPL"  ' Example ticker symbol
    api_token = "your_api_token_here"  ' Your API token

    ' Call the function
    status = AlpGet_MutualFund_Holders(ticker, api_token)

    ' Display status
    MsgBox "Operation completed with status: " & status
End Sub
</code></pre>

        <h2>Notes</h2>
        <ul>
            <li>Ensure that your Excel environment has the JSON parsing capabilities installed (e.g., through a VBA-JSON library).</li>
            <li>Make sure your VBA project has enabled references to required libraries such as "Microsoft XML, v6.0" for XMLHTTP support.</li>
            <li>Set up appropriate error handling in your calling code to handle any potential issues during API access or data processing.</li>
        </ul>
    </div>
</body>

</html>
