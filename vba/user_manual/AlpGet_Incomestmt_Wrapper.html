
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Manual for AlpGet_Incomestmt</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        code {
            background-color: #f8f9fa;
            padding: 0.2em 0.4em;
            font-family: Consolas, "Courier New", monospace;
        }

        pre {
            background-color: #f8f9fa;
            padding: 1em;
            border: 1px solid #e9ecef;
        }
    </style>
</head>

<body class="container mt-5">
    <h1 class="mb-4">User Manual for AlpGet_Incomestmt Function</h1>

    <h2>Description</h2>
    <p>The <code>AlpGet_Incomestmt</code> function retrieves the income statement for a specified ticker symbol using the provided API token. It makes a GET request to a specified local endpoint, parsing the JSON response and populating it into an Excel worksheet starting from the currently active cell.</p>

    <h2>Function Syntax</h2>
    <pre><code>AlpGet_Incomestmt(ticker As String, api_token As String) As String</code></pre>

    <h2>Parameters</h2>
    <ul>
        <li><strong><code>ticker</code></strong>: A string representing the ticker symbol for which the income statement is retrieved.</li>
        <li><strong><code>api_token</code></strong>: A string representing the API token for accessing the income statement service.</li>
    </ul>

    <h2>Return Value</h2>
    <p>The function returns a concatenated string of the format <code>ticker-api_token</code>, representing the input parameters. This primarily acts as a confirmation of the input received as the data is written directly into the Excel sheet.</p>

    <h2>Example Usage</h2>
    <p>To retrieve the income statement for the ticker <code>"AAPL"</code> using the API token <code>"your_api_token"</code>, and populate this in the currently active cell of an Excel spreadsheet, use the following VBA code:</p>

    <pre><code>
Dim result As String
result = AlpGet_Incomestmt("AAPL", "your_api_token")
Debug.Print result
    </code></pre>

    <h2>Notes</h2>
    <ul>
        <li>Ensure that the <code>JsonConverter</code> library is available and properly referenced in your VBA project for JSON parsing.</li>
        <li>The function relies on the data being available at the local endpoint <code>http://localhost:5000/incomestmt</code>; ensure that this service is running and accessible.</li>
        <li>Errors during processing are captured and displayed in a message box.</li>
    </ul>
</body>

</html>
