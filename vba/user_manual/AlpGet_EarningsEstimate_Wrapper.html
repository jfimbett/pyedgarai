
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <title>AlpGet_EarningsEstimate Function Manual</title>
    <style>
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #e3e3e3;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h3 class="mb-4">User Manual for <code>AlpGet_EarningsEstimate</code> Function</h3>
        
        <h4>Description</h4>
        <p>The <code>AlpGet_EarningsEstimate</code> function fetches the earnings estimate data for a given stock ticker using an API. It retrieves the data in JSON format and inserts it into the current Excel sheet starting from the active cell. The function returns the ticker symbol, confirming the operation's success.</p>
        
        <h4>Dependencies</h4>
        <ul>
            <li><code>MSXML2.XMLHTTP</code> for making HTTP requests.</li>
            <li>A JSON parser such as <code>JsonConverter</code> module that should be included in the project.</li>
        </ul>
        
        <h4>Parameters</h4>
        <ul>
            <li><code>ticker</code>: A <code>String</code> representing the stock ticker symbol.</li>
            <li><code>api_token</code>: A <code>String</code> that holds the API token used for authentication.</li>
        </ul>

        <h4>Usage</h4>
        <p>Here is how you can use the function in your VBA code:</p>
        <pre>
Sub FetchEarningsEstimate()
    Dim result As String
    result = AlpGet_EarningsEstimate("AAPL", "your_api_token_here")
    MsgBox "Data fetched for: " & result
End Sub
        </pre>

        <h4>Error Handling</h4>
        <p>Errors might occur during the execution of the function, such as network issues or invalid API endpoints. The function will show an error message box in such cases. Ensure your API endpoint is correct and reachable, and that you have the necessary permissions.</p>

        <h4>Output</h4>
        <p>The function outputs the earnings estimates data directly into the Excel worksheet starting from the currently active cell. Each period's data is displayed in consecutive rows, with headers for each data column.</p>

        <h4>Example</h4>
        <p>Suppose you want to fetch earnings estimates for the ticker <code>GOOGL</code>. You can use the following snippet:</p>
        <pre>
Sub ExampleUsage()
    Dim result As String
    result = AlpGet_EarningsEstimate("GOOGL", "your_api_token_here")
    If result <> "" Then
        MsgBox "Earnings estimate for " & result & " successfully fetched!"
    Else
        MsgBox "Earnings estimate could not be retrieved."
    End If
End Sub
        </pre>
    </div>
</body>
</html>
