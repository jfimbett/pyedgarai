
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Function User Manual</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
        }
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            font-family: Consolas, monospace;
            color: #212529;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mt-4">AlpGet_quarterly_income_stmt Function User Manual</h1>
        <p>The <code>AlpGet_quarterly_income_stmt</code> function serves as an accessible interface to retrieve and display quarterly income statements for a specified company ticker on an Excel spreadsheet. It leverages an API to fetch the data in JSON format, which it then parses and organizes into a tabular format on the active Excel sheet.</p>
        
        <h2>Function Definition</h2>
        <h3>AlpGet_quarterly_income_stmt_Wrapper(ticker As String, api_token As String) As String</h3>
        <p>The wrapper function communicates directly with an API to request quarterly income statement data for a specified ticker symbol.</p>
        
        <h3>AlpGet_quarterly_income_stmt(ticker As String, api_token As String) As String</h3>
        <p>This is a high-level function that calls the wrapper and returns the result. Use this function to conveniently display data.</p>
        
        <h2>Parameters</h2>
        <ul>
            <li><strong>ticker</strong> (String): The stock ticker symbol for the company whose quarterly income statement you want to retrieve.</li>
            <li><strong>api_token</strong> (String): Your API authentication token required to access the API endpoint.</li>
        </ul>

        <h2>Return Value</h2>
        <p>Returns the ticker symbol provided if the function executes successfully; otherwise, an error message is displayed if something goes wrong.</p>

        <h2>Usage Examples</h2>
        <h3>VBA Code Example:</h3>
        <pre>
Sub ExampleUsage()
    Dim result As String
    result = AlpGet_quarterly_income_stmt("AAPL", "your_api_token_here")
    MsgBox "Data Retrieved for Ticker: " & result
End Sub
        </pre>

        <h3>Excel Worksheet Usage:</h3>
        <p>Select a cell you want the data to start displaying from, and run a VBA macro like the below:</p>
        <pre>
Sub DisplayIncomeStatement()
    Dim ticker As String
    Dim api_token As String
    ticker = "MSFT"
    api_token = "your_api_token_here"
    Call AlpGet_quarterly_income_stmt(ticker, api_token)
End Sub
        </pre>

        <h2>Error Handling</h2>
        <p>In case of an error (e.g., invalid API token, incorrect ticker symbol), a message box will appear displaying a descriptive error message.</p>
    </div>
</body>
</html>
